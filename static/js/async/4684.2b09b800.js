"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["4684"],{1036:function(e,n,r){r.r(n),r.d(n,{Wrap:()=>c,default:()=>a});var d=r(2676),s=r(453),i=r(1305);function c(e){let{children:n}=e,r=Object.assign({div:"div"},(0,s.ah)()),i={background:"var(--rp-c-bg-mute)",borderRadius:"6px",textAlign:"center",fontSize:"18px",leading:"2em",marginBottom:"1em"};return(0,d.jsxs)(r.div,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,d.jsxs)(r.div,{style:{border:"1px solid rgba(255,255,255, 0.1)",borderRadius:"8px"},children:[(0,d.jsx)(r.div,{style:i,children:"账号登录"}),n[0]]}),(0,d.jsxs)(r.div,{style:{border:"1px solid rgba(255,255,255, 0.1)",borderRadius:"8px"},children:[(0,d.jsx)(r.div,{style:i,children:"mtds登录"}),n[1]]})]})}function h(e){let n=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",h3:"h3",h4:"h4",ul:"ul",li:"li",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",code:"code",div:"div",ol:"ol",pre:"pre"},(0,s.ah)(),e.components);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n.h1,{id:"登录",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#登录",children:"#"}),"登录"]}),"\n",(0,d.jsxs)(n.h2,{id:"1-概述",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1-概述",children:"#"}),"1. 概述"]}),"\n",(0,d.jsx)(n.p,{children:"设计软件登录功能，统一登录功能实现。"}),"\n",(0,d.jsx)(i.Z,Object.assign({code:"flowchart TB\r\n  web-user[账号信息]\r\n  soft-user[账号信息]\r\n  web-device[设备信息]\r\n  soft-device[设备信息]\r\n  login-success[登录成功]\r\n\r\n  param --\x3e login-success\r\n  login-success --\x3e 登录数据\r\n  soft-cache <--\x3e param\r\n  style soft-user stroke:#c9c9c9,stroke-width:2px,color:#fff,stroke-dasharray: 5 5\r\n  style web-device stroke:#c9c9c9,stroke-width:2px,color:#fff,stroke-dasharray: 5 5\r\n  subgraph soft\r\n    direction LR\r\n    登录数据\r\n    subgraph soft-cache\r\n      direction BT\r\n      soft-user\r\n      soft-device\r\n    end\r\n  end\r\n  subgraph web\r\n    direction TB\r\n    web-device\r\n    login-success\r\n    subgraph param\r\n      web-user\r\n      web-device\r\n    end\r\n  end\r\n  "},{config:{theme:"dark"}})),"\n",(0,d.jsxs)(n.h2,{id:"2-地址",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2-地址",children:"#"}),"2. 地址"]}),"\n",(0,d.jsxs)(n.h3,{id:"21-登录",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#21-登录",children:"#"}),"2.1 登录"]}),"\n",(0,d.jsxs)(n.h4,{id:"211--地址",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#211--地址",children:"#"}),"2.1.1  地址"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["正式环境：",(0,d.jsx)(n.a,{href:"https://auth.ihomecloud.com.cn/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001",rel:"noopener noreferrer",target:"_blank",children:"https://auth.ihomecloud.com.cn/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001"})]}),"\n",(0,d.jsxs)(n.li,{children:["VER环境：",(0,d.jsx)(n.a,{href:"https://ver-auth.ihomecloud.com.cn/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001",rel:"noopener noreferrer",target:"_blank",children:"https://ver-auth.ihomecloud.com.cn/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001"})]}),"\n",(0,d.jsxs)(n.li,{children:["测试环境：",(0,d.jsx)(n.a,{href:"https://uat-auth.ihomecloud.com.cn/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001",rel:"noopener noreferrer",target:"_blank",children:"https://uat-auth.ihomecloud.com.cn/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001"})]}),"\n"]}),"\n",(0,d.jsxs)(n.h4,{id:"212-英文版本",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#212-英文版本",children:"#"}),"2.1.2 英文版本"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["正式环境：",(0,d.jsx)(n.a,{href:"https://auth.ihomecloud.com.cn/en/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001",rel:"noopener noreferrer",target:"_blank",children:"https://auth.ihomecloud.com.cn/en/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001"})]}),"\n",(0,d.jsxs)(n.li,{children:["VER环境：",(0,d.jsx)(n.a,{href:"https://ver-auth.ihomecloud.com.cn/en/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001",rel:"noopener noreferrer",target:"_blank",children:"https://ver-auth.ihomecloud.com.cn/en/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001"})]}),"\n",(0,d.jsxs)(n.li,{children:["测试环境：",(0,d.jsx)(n.a,{href:"https://uat-auth.ihomecloud.com.cn/en/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001",rel:"noopener noreferrer",target:"_blank",children:"https://uat-auth.ihomecloud.com.cn/en/auth/homedesign/login?prdCode=HomeDesign&macAddress=00:0c:29:9a:1e:0a&diskID=5B4D-5B4D&port=1001"})]}),"\n"]}),"\n",(0,d.jsxs)(n.h4,{id:"213-参数说明",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#213-参数说明",children:"#"}),"2.1.3 参数说明"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"参数"}),(0,d.jsx)(n.th,{children:"说明"}),(0,d.jsx)(n.th,{children:"值"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"prdCode"})}),(0,d.jsx)(n.td,{children:"产品编码"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"HomeDesign"})," | ",(0,d.jsx)(n.code,{children:"HomeDesign(Standard)"})," | ",(0,d.jsx)(n.code,{children:"iHomeCloud"})," | ",(0,d.jsx)(n.code,{children:"iHomeCloud(Standard)"})]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"macAddress"})}),(0,d.jsx)(n.td,{children:"mac地址"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"00:0c:29:9a:1e:0a"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"diskID"})}),(0,d.jsx)(n.td,{children:"硬盘号"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"5B4D-5B4D"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"port"})}),(0,d.jsx)(n.td,{children:"websocket端口号"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"1001"})})]})]})]}),"\n",(0,d.jsxs)(n.h2,{id:"3-流程",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#3-流程",children:"#"}),"3. 流程"]}),"\n",(0,d.jsx)("div",{style:{display:"grid",gridTemplateColumns:"70%",justifyContent:"center"},children:(0,d.jsx)(i.Z,Object.assign({code:"flowchart TB\r\n  classDef green stroke:#23C343,stroke-width:1px,color:#23C343;\r\n  classDef orange stroke:#FF9A2E,stroke-width:2px,color:#FF9A2E;\r\n  class merge className;\r\n  login[正常登录]\r\n  deviceCheck(设备检查)\r\n  is_valid_mtds[是否开通mtds]\r\n  selectLogin[选择登录方式]\r\n  is_new_mtds[是否注册]\r\n  has_regist_phone{{是否已绑定手机号}}:::orange\r\n  regist_phone[绑定手机号]:::orange\r\n  regist_uni{{选择注册平台账号方式}}\r\n  regist_account[注册统一账号]\r\n  merge_uniphone[合并至统一手机号]:::orange\r\n  \r\n  regist_phone_success[绑定至手机号]\r\n  chose_regist_phone{{是否绑定手机号}}:::orange\r\n  subgraph MTDS\r\n    is_valid_mtds\r\n    is_new_mtds\r\n    regist_uni\r\n    regist_account\r\n  end\r\n  selectLogin --\x3e |mtds|is_valid_mtds --\x3e|是|is_new_mtds\r\n  selectLogin ----\x3e |账号+密码 \\n 微信扫码|has_regist_phone\r\n  is_new_mtds --\x3e |已注册|has_regist_phone\r\n  is_new_mtds --\x3e |未注册|regist_uni\r\n  has_regist_phone --\x3e |已绑定|deviceCheck\r\n  has_regist_phone --\x3e |未绑定|chose_regist_phone\r\n  chose_regist_phone --\x3e |不绑定|deviceCheck\r\n  chose_regist_phone --\x3e |绑定|regist_phone\r\n  regist_phone ---\x3e |触发合并|merge_uniphone\r\n  regist_phone ---\x3e |未触发合并|regist_phone_success\r\n  regist_uni --\x3e|手机号|regist_phone\r\n  merge_uniphone --\x3e deviceCheck\r\n  regist_phone_success --\x3e deviceCheck \r\n  regist_uni --\x3e|账号|regist_account ----\x3e deviceCheck\r\n  deviceCheck --\x3e |检查成功|login"},{config:{theme:"dark"}}))}),"\n",(0,d.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,d.jsx)(n.div,{className:"rspress-directive-title",children:"合并"}),(0,d.jsx)(n.div,{className:"rspress-directive-content",children:(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsx)(n.li,{children:"绑定手机号、修改手机号时，若手机号已绑定其他租户的账号，将触发合并。"}),"\n",(0,d.jsx)(n.li,{children:"一个手机号能够与多个不同租户的账号进行绑定。但是在同一个租户下，一个手机号只能绑定一个账号。"}),"\n"]})})]}),"\n",(0,d.jsxs)(n.h3,{id:"31-微信扫码登录",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#31-微信扫码登录",children:"#"}),"3.1 微信扫码登录"]}),"\n",(0,d.jsx)(i.Z,Object.assign({code:"flowchart RL\r\n  web(网站)\r\n  mini((小程序))\r\n  backend[(后端)]\r\n\r\n  backend --\x3e|2. 返回临时ticket|web\r\n  web --\x3e|3. 携带ticket跳转|mini\r\n  mini --\x3e|4. 携带ticket + code登录 |backend\r\n  backend --\x3e|5. code换uniId->登录|backend\r\n  web --\x3e|1. 向后端请求临时ticket|backend\r\n  backend <--\x3e|∞轮询ticket是否登录，返回登录信息|web\r\n\r\n  subgraph 后端\r\n  backend\r\n  end\r\n  subgraph 网页\r\n  web\r\n  end\r\n  subgraph 小程序\r\n  mini\r\n  end"},{config:{theme:"dark"}})),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["后端接口","\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:["获取临时",(0,d.jsx)(n.code,{children:"ticket"}),", ",(0,d.jsx)(n.code,{children:"ticket"}),"有效时间1分钟"]}),"\n"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"/get/ticket"})}),"\n"]}),"\n",(0,d.jsxs)(n.ol,{start:"2",children:["\n",(0,d.jsx)(n.li,{children:"轮询接口，返回登录状态"}),"\n"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"/wxQrcodeStatus?ticket=173090909090"})}),"\n"]}),"\n",(0,d.jsxs)(n.ol,{start:"3",children:["\n",(0,d.jsxs)(n.li,{children:["登录接口，根据前端传的",(0,d.jsx)(n.code,{children:"code"})," + ",(0,d.jsx)(n.code,{children:"ticket"}),"换取",(0,d.jsx)(n.code,{children:"uniId"}),"查询用户登录"]}),"\n"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["没有这个用户就返回让页面显示注册，有就存到",(0,d.jsx)(n.code,{children:"ticket"}),"，前端根据轮询状态用",(0,d.jsx)(n.code,{children:"ticket"}),"获取"]}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"/wxlogin/ticket=173009090&uniId=987878789"})}),"\n",(0,d.jsxs)(n.li,{children:["之前这个接口 ",(0,d.jsx)(n.code,{children:"/admin/account/getAccountByCode"})," 可以根据",(0,d.jsx)(n.code,{children:"code"}),"查找微信",(0,d.jsx)(n.code,{children:"uniId"}),"并获取用户信息"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(n.h2,{id:"4-软件登录",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#4-软件登录",children:"#"}),"4. 软件登录"]}),"\n",(0,d.jsxs)(n.h3,{id:"41-缓存账号信息",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#41-缓存账号信息",children:"#"}),"4.1 缓存账号信息"]}),"\n",(0,d.jsx)(n.p,{children:"登录成功后（记住密码），将账号列表全部缓存至软件"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"如果账号已经登录过，第二次登录密码不一致时（1. 第一次未记住密码并且第二次记住密码。2. 忘记密码后修改密码）会导致修改密码的情况（与现有只支持存取的逻辑冲突），所以全部由web处理，软件只需要每次用web端传入的数据覆盖上一次缓存数据。"}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",meta:"title=#example",children:'  // send to HomdDesign\r\n  {\r\n    code: "CACHE_ACCOUNT",\r\n    params: [{\r\n      account: "account",\r\n      password: "password"  // 加密处理\r\n    }, ...]\r\n  }\r\n  // send to web\r\n  {\r\n    status: true,\r\n    code: "CACHE_ACCOUNT",\r\n    message: "error message",\r\n    // 有用户信息就返回，没有返回null\r\n    data: null                    \r\n  }\n'})}),"\n",(0,d.jsxs)(n.h3,{id:"42-获取账号信息",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#42-获取账号信息",children:"#"}),"4.2 获取账号信息"]}),"\n",(0,d.jsx)(n.p,{children:"第一次登录并记住密码缓存至软件，第二次登录需要从软件获取账号信息"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",meta:"title=#example",children:'  // send to HomdDesign\r\n  {\r\n    code: "DISPLAY_ACCOUNTS",\r\n    params: null\r\n  }\r\n  // send to web\r\n  {\r\n    status: true,\r\n    code: "DISPLAY_ACCOUNTS",\r\n    message: "error message",\r\n    // 有用户信息就返回，没有返回空数组\r\n    data: [{\r\n      account: "account",\r\n      password: "password" // 加密处理\r\n    }, ...]\r\n  },\n'})}),"\n",(0,d.jsxs)(n.h3,{id:"43-登录成功",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#43-登录成功",children:"#"}),"4.3 登录成功"]}),"\n",(0,d.jsx)(n.p,{children:"登录成功后，将用户数据发送至软件"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",meta:"title=#example",children:'// send to HomdDesign\r\n{\r\n  code: "LOGIN_SUCCESS",\r\n    // 登录成功返回的用户信息\r\n  params: {\r\n    "accessToken": "a65bd6ee-9ddd-43f2-a239-38935a07d653",\r\n    "refreshToken": "d97a147e-5057-4b6e-b542-a5762647de61",\r\n    "expires_in": 86399,\r\n    "access_token_expired_seconds": 86400,\r\n    "refresh_token_expired_seconds": 604800,\r\n    "userinfo": {\r\n      "id": "e8c79585-cf99-4089-861c-1a93d9681831",\r\n      "type": 1,\r\n      "designType": 1,\r\n      "accountNumAbility": "71|9|0|72|10|2|74|17|143|3|4|6|5|8|7|73|139|138|140|141|264|265|201|185|187|21|1|12|22|25|15|24|14|13|23|33|32|31|37|36|35|19|41|16|18|179|142|194|160|161|200|195|162|204|167|205|196|212|173|174|175|159|51|60|52|152|54|70|53|56|55|58|59|169|190|61|170|65|64|66|62|69|68|75|63|334|333|329|203|208|186|79|214|209|165|221|166|163|199|124|125|191|192|186",\r\n      "accountNumAbility1": "",\r\n      "tenantCode": "oppein",\r\n      "tenantName": "欧派家居集团",\r\n      "tenantType": "2",\r\n      "expiredInfo": null,\r\n      "userCategory": "模块权限：\\n账号开通：2025-12-31 到期\\n衣柜模块：2025-12-31 到期\\n橱柜模块：2025-12-31 到期\\n木门模块：2025-12-31 到期\\n卫浴模块：2025-12-31 到期\\n衣柜拆板报价模块：2025-12-31 到期\\n衣柜套餐报价模块：2025-12-31 到期\\n金属门窗模块：2025-12-31 到期\\n阳台柜模块：2025-12-31 到期\\n",\r\n      "category": [{\r\n        "name": "Caxa设计软件账户开通",\r\n        "code": "Ca_AC_Open",\r\n        "expired": "2025-12-31"\r\n      }],\r\n      "apiUrls":  {},\r\n      "thirdAccount": {\r\n        "thirdId": "",\r\n        "access_token": "",\r\n        "refresh_token": "",\r\n        "thirdId": ""\r\n      },\r\n      "configLibId": "a0259b9a-3501-41a1-8a6c-98782b0b4bf6",\r\n      "authorities": [\r\n      {\r\n        "authority": "pool_folder_set_refresh"\r\n      }],\r\n      "sharedTenant": null\r\n    }\r\n  }\r\n  \r\n}\r\n\n'})}),"\n","\n",(0,d.jsxs)(n.h3,{id:"44-关闭窗口",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#44-关闭窗口",children:"#"}),"4.4 关闭窗口"]}),"\n",(0,d.jsx)(n.p,{children:"关闭当前的窗口"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",meta:"title=#example",children:'  // send to HomeDesign\r\n  {\r\n    code: "CLOSE_CHROMEWINDOW"\r\n    param: null\r\n  }\n'})}),"\n",(0,d.jsxs)(n.h3,{id:"45-加载进度",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#45-加载进度",children:"#"}),"4.5 加载进度"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",meta:"title=#example",children:'  // send to web\r\n  {\r\n    code: "LOADING_PROGRESS"\r\n    data: "提示信息"\r\n  }\n'})}),"\n",(0,d.jsxs)(n.h2,{id:"5-统一登录",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#5-统一登录",children:"#"}),"5. 统一登录"]}),"\n",(0,d.jsxs)(n.h3,{id:"51-地址",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#51-地址",children:"#"}),"5.1 地址"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["正式环境：",(0,d.jsx)(n.a,{href:"https://auth.ihomecloud.com.cn/auth/login?redir_url=aHR0cHMlM0ElMkYlMkZhZG1pbi5qaWFqdXRlY2guY29t&from=admin",rel:"noopener noreferrer",target:"_blank",children:"https://auth.ihomecloud.com.cn/auth/login?redir_url=aHR0cHMlM0ElMkYlMkZhZG1pbi5qaWFqdXRlY2guY29t&from=admin"})]}),"\n",(0,d.jsxs)(n.li,{children:["测试环境：",(0,d.jsx)(n.a,{href:"https://uat-auth.ihomecloud.com.cn/auth/login?redir_url=aHR0cHMlM0ElMkYlMkZhZG1pbi5qaWFqdXRlY2guY29t&from=admin",rel:"noopener noreferrer",target:"_blank",children:"https://uat-auth.ihomecloud.com.cn/auth/login?redir_url=aHR0cHMlM0ElMkYlMkZhZG1pbi5qaWFqdXRlY2guY29t&from=admin"})]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"参数说明"})}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"redir_url"}),"：回调地址encode后base64加密"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"from"}),": 来源，用于区分是哪个系统登录"]}),"\n"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"站点"}),(0,d.jsx)(n.th,{children:"from"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"后台管理"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"admin"})," | ",(0,d.jsx)(n.code,{children:"pig"})]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"官网"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"home"})," | ",(0,d.jsx)(n.code,{children:"portal"})]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"video"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"jiajuvideo"})})]})]})]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"其他值在后台管理 /admin/client/index 查询"}),"\n"]}),"\n",(0,d.jsxs)(n.h3,{id:"52-登录成功",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#52-登录成功",children:"#"}),"5.2 登录成功"]}),"\n",(0,d.jsxs)(n.p,{children:["登录成功后，会自动跳转到",(0,d.jsx)(n.code,{children:"redir_url"}),"解码后的地址，并携带tokenId参数。"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",meta:"title=自动跳转回调",children:"https://admin.ihomecloud.com.cn?tokenId=xxxxxx\n"})}),"\n",(0,d.jsxs)(n.p,{children:["子系统获取tokenId后，调用 ",(0,d.jsx)(n.code,{children:"GET：/auth/token/info?token=xxx"})," 接口获取登录信息"]}),"\n",(0,d.jsxs)(n.h2,{id:"6-作为iframe",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#6-作为iframe",children:"#"}),"6. 作为iframe"]}),"\n",(0,d.jsxs)(n.h3,{id:"61-地址",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#61-地址",children:"#"}),"6.1 地址"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["正式环境：",(0,d.jsx)(n.a,{href:"https://auth.ihomecloud.com.cn/auth/login/inner?from=admin",rel:"noopener noreferrer",target:"_blank",children:"https://auth.ihomecloud.com.cn/auth/login/inner?from=admin"})]}),"\n",(0,d.jsxs)(n.li,{children:["测试环境：",(0,d.jsx)(n.a,{href:"https://uat-auth.ihomecloud.com.cn/auth/login/inner?from=admin",rel:"noopener noreferrer",target:"_blank",children:"https://uat-auth.ihomecloud.com.cn/auth/login/inner?from=admin"})]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"参数说明"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"from"}),": 来源，用于区分是哪个系统登录，值同上。"]}),"\n"]}),"\n",(0,d.jsxs)(n.h3,{id:"62-登录成功",children:[(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#62-登录成功",children:"#"}),"6.2 登录成功"]}),"\n",(0,d.jsx)(n.p,{children:"登录成功后，会通过postMessage向父窗口发送消息，消息内容如下："}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",meta:"title=#example",children:'{\r\n  "type": "login",\r\n  "tokenId": "xxxxx"\r\n}\n'})}),"\n",(0,d.jsxs)(n.p,{children:["子系统获取tokenId后，调用 ",(0,d.jsx)(n.code,{children:"GET：/auth/token/info?token=xxx"})," 接口获取登录信息"]})]})}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,d.jsx)(n,Object.assign({},e,{children:(0,d.jsx)(h,e)})):h(e)}let a=t;t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["guide%2Flogin.mdx"]={toc:[{id:"1-概述",text:"1. 概述",depth:2},{id:"2-地址",text:"2. 地址",depth:2},{id:"21-登录",text:"2.1 登录",depth:3},{id:"211--地址",text:"2.1.1  地址",depth:4},{id:"212-英文版本",text:"2.1.2 英文版本",depth:4},{id:"213-参数说明",text:"2.1.3 参数说明",depth:4},{id:"3-流程",text:"3. 流程",depth:2},{id:"31-微信扫码登录",text:"3.1 微信扫码登录",depth:3},{id:"4-软件登录",text:"4. 软件登录",depth:2},{id:"41-缓存账号信息",text:"4.1 缓存账号信息",depth:3},{id:"42-获取账号信息",text:"4.2 获取账号信息",depth:3},{id:"43-登录成功",text:"4.3 登录成功",depth:3},{id:"44-关闭窗口",text:"4.4 关闭窗口",depth:3},{id:"45-加载进度",text:"4.5 加载进度",depth:3},{id:"5-统一登录",text:"5. 统一登录",depth:2},{id:"51-地址",text:"5.1 地址",depth:3},{id:"52-登录成功",text:"5.2 登录成功",depth:3},{id:"6-作为iframe",text:"6. 作为iframe",depth:2},{id:"61-地址",text:"6.1 地址",depth:3},{id:"62-登录成功",text:"6.2 登录成功",depth:3}],title:"登录",headingTitle:"登录",frontmatter:{}}}}]);